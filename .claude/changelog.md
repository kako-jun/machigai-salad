# 変更履歴

## [Unreleased]

### 追加予定

- 差分の自動検出機能
- PWA対応
- 画像保存機能

## [0.2.0] - 2025-01-XX

### 追加 ✨

- **紙の自動検出機能**
  - OpenCV.jsのCannyエッジ検出で紙の輪郭を抽出
  - 複数のしきい値（30/100, 50/150, 75/200）で試行
  - 4角形の自動検出
  - 検出面積を5%に緩和（従来は10%）

- **台形補正（透視変換）**
  - `getPerspectiveTransform`で変換行列を計算
  - `warpPerspective`で画像を正面視に変換
  - 斜めから撮影した画像にも対応

- **角の調整UIコンポーネント**
  - 自動検出した4つの角をオレンジ色の点で表示
  - マウス/タッチでドラッグして微調整可能
  - ドラッグ中の角が光るグロー効果
  - 方向を示す矢印絵文字（↖️↗️↘️↙️）
  - リセット、キャンセル、適用の3つのボタン

### 改善 🎨

- **子供向けUIに全面刷新**
  - 専門用語を平易な言葉に変更
    - 「紙の範囲を調整」→「📄 まっすぐに直そう！」
    - 「適用」→「これでOK！」
    - 「別の画像を読み込む」→「🔄 別の絵で遊ぶ」
  - 絵文字を多用（🍤🎯📷💡など）
  - オレンジ〜イエローのグラデーション背景
  - ボタンにタップアニメーション（active:scale-95）

- **エラーメッセージの改善**
  - 「画像の処理中にエラーが発生しました」
    → 「😅 うまくいかなかったみたい。もう一度写真をとってみてね！」
  - ローディング: 「🔍 絵をチェック中... ちょっと待ってね！」

- **認識精度の向上**
  - 複数のepsilon値（0.02, 0.03, 0.04）で四角形近似を試行
  - 良い候補（20%以上）が見つかったら早期終了
  - より多くのケースで紙を検出可能に

- **角の調整UIのビジュアル改善**
  - 太い線（lineWidth: 3）で見やすく
  - 影付きで立体感を演出
  - 選択中の角を明るく表示
  - 白い縁取りでコントラスト向上

### 変更 🔧

- 画像処理フローを2段階に分割
  1. `detectPaperCorners()`: 紙の検出
  2. `processImageWithCorners()`: 台形補正〜分割

- 新しいコンポーネント追加
  - `PaperCornersAdjustment.tsx`: 角の調整UI

- 状態管理の追加
  - `detectedCorners`: 検出した4つの角の座標
  - `showCornersAdjustment`: 調整UI表示フラグ

## [0.1.0] - 2025-01-XX

### 追加 ✨

- **初期リリース**
  - カメラで撮影 / ファイルから画像を選択
  - OpenCV.jsの動的ロード
  - 色調補正（ヒストグラム均等化）
  - 画像の左右分割
  - タップで画像を切り替えて比較
  - レスポンシブデザイン
  - Next.js 15で静的サイトとしてビルド
  - GitHub Pagesへの自動デプロイ

### コンポーネント

- `ImageProcessor.tsx`: 画像処理の統合コンポーネント
- `ImageUpload.tsx`: 画像アップロードUI
- `ImageComparison.tsx`: 左右画像の比較UI

### 技術スタック

- Next.js 15
- React 19
- TypeScript
- Tailwind CSS
- OpenCV.js 4.9.0

## リリースノート形式

### バージョン表記

- メジャー: 大きな機能追加や破壊的変更
- マイナー: 機能追加や改善
- パッチ: バグフィックスや小さな修正

### カテゴリ

- ✨ 追加 (Added): 新機能
- 🎨 改善 (Improved): 既存機能の改善
- 🔧 変更 (Changed): 動作の変更
- 🐛 修正 (Fixed): バグフィックス
- 🗑️ 削除 (Removed): 機能の削除
- 🔒 セキュリティ (Security): 脆弱性対応
- 📚 ドキュメント (Documentation): ドキュメント更新

## 今後の予定

### v0.3.0（予定）

- PWA対応
- オフライン動作
- 画像保存機能
- 差分の自動検出（実験的）

### v0.4.0（予定）

- 多言語対応（英語）
- ダークモード
- チュートリアル追加

### v1.0.0（目標）

- 全機能の安定動作
- 充実したテスト
- パフォーマンス最適化
- 完全なドキュメント
